<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>CollabVM Toolkit (Online)</title>
	<style>
		* {
			margin: 0;
		}

		.actions {
			align-items: center;
			text-align: center;
			background-color: rgb(158, 255, 155);
			padding-bottom: 2.5%;
			padding-top: 2.5%;

			h1 {
				padding-bottom: 2%;
			}

			;

			button {
				margin-left: 1%;
			}

			button:disabled {
				background-color: gray;
			}

		}

		;
	</style>
	<script>
		function DemoteFromActiveDirectory() {
			try {
				var strComputer = ".";
				var network = new ActiveXObject("WScript.Network");
				var strUser = network.ComputerName;
				var locator = new ActiveXObject("WbemScripting.SWbemLocator");
				var service = locator.ConnectServer(strComputer, "root\\cimv2");
				var systems = service.ExecQuery("Select * from Win32_ComputerSystem");
				var e = new Enumerator(systems);
				for (; !e.atEnd(); e.moveNext()) {
					var computer = e.item();
					var result = computer.UnjoinDomainOrWorkgroup("", strUser, 0);
				}
			} catch (err) {
				alert(err)
			}
		}
	</script>
	<script>
		var strComputer = ".";
		var objWMIService = GetObject("winmgmts:\\\\" + strComputer + "\\root\\cimv2");

		var colItems = new Enumerator(
			objWMIService.ExecQuery("SELECT PartOfDomain, Domain FROM Win32_ComputerSystem")
		);

		for (; !colItems.atEnd(); colItems.moveNext()) {
			var objItem = colItems.item();

			if (objItem.PartOfDomain) {
				alert(objItem.Domain);
			} else {
				alert("Not in domain!");
			}
		}
	</script>
</head>

<body>
	<div class="actions">
		<h1>CollabVM ToolKit</h1>
		<button id="demotead" onclick="DemoteFromActiveDirectory()">TODO: Demote from Windows Domain</button>
		<button id="BkgLockout" disabled="">TODO: Launch BkgLockout</button>
		<button id="LeaveLanSchoo" disabled="">TODO: Quit LanSchool</button><br>
		<button id="dispwroption" disabled="">TODO: Disable Power Options</button>
		<button id="rewindpol" disabled="">TODO: Remove policy</button>
	</div><br>
	<p>Made by initgoatfs<br>
		<button>TODO: Download to your CollabUSB or CollabFloppy</button>
</body>

</html>
