<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>CollabVM Toolkit (Online)</title>
	<style>
		* {
			margin: 0;
		}

		.actions {
			align-items: center;
			text-align: center;
			background-color: rgb(158, 255, 155);
			padding-bottom: 2.5%;
			padding-top: 2.5%;

			h1 {
				padding-bottom: 2%;
			}

			;

			button {
				margin-left: 1%;
			}

			button:disabled {
				background-color: gray;
			}

		}

		;
	</style>
	<script>
		function DemoteFromActiveDirectory() {
			try {
				var strComputer = ".";
				var network = new ActiveXObject("WScript.Network");
				var strUser = network.ComputerName;
				var locator = new ActiveXObject("WbemScripting.SWbemLocator");
				var service = locator.ConnectServer(strComputer, "root\\cimv2");
				var systems = service.ExecQuery("Select * from Win32_ComputerSystem");
				var e = new Enumerator(systems);
				for (; !e.atEnd(); e.moveNext()) {
					var computer = e.item();
					alert("Attempting to leave domain...")
					var result = computer.UnjoinDomainOrWorkgroup("", strUser, 0);
					if (result == 5) {
						alert("Please run as admin and try again. (ERROR_ACCESS_DENIED)")
					} else if (result == 0) {
						alert("Left domain! Please logout to continue!")
					} else if (result == 2695) {
						alert("Big error please reboot (NERR_InvalidWorkgroupName)")
					} else {
						alert("Error: " + result)
					}
				}
			} catch (err) {
				alert(err)
			}
		}
	</script>
	<script>
		function checkdomain() {
			var locator = new ActiveXObject("WbemScripting.SWbemLocator"); // create WMI locator
			var service = locator.ConnectServer(".", "root\\cimv2");       // connect to local WMI namespace

			var query = "SELECT PartOfDomain, Domain FROM Win32_ComputerSystem";
			var colItems = service.ExecQuery(query);

			var e = new Enumerator(colItems);
			for (; !e.atEnd(); e.moveNext()) {
				var item = e.item();
				if (item.PartOfDomain) {
					alert("You are in a domain! Click Demote from windows Domain!");
				} else {
					document.querySelectorAll('#demotead')[0].remove()
					document.querySelectorAll('#BkgLockout')[0].removeAttribute("disabled")
					document.querySelectorAll('#LeaveLanSchool')[0].removeAttribute("disabled")
					document.querySelectorAll('#dispwroption')[0].removeAttribute("disabled")
					document.querySelectorAll('#rewindpol')[0].removeAttribute("disabled")
					
				}
			}
		}
	</script>
</head>

<body>
	<div class="actions">
		<h1>CollabVM ToolKit</h1>
		<button id="demotead" onclick="DemoteFromActiveDirectory()">Demote from Windows Domain</button>
		<button id="BkgLockout" disabled="">TODO: Launch BkgLockout</button>
		<button id="LeaveLanSchool" disabled="">TODO: Quit LanSchool</button><br>
		<button id="dispwroption" disabled="">TODO: Disable Power Options</button>
		<button id="rewindpol" disabled="">TODO: Remove policy</button>
	</div><br>
	<p>Made by initgoatfs<br>
		<button>TODO: Download to your CollabUSB or CollabFloppy</button>
</body>

</html>
